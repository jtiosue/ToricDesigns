(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36335,        919]
NotebookOptionsPosition[     34158,        873]
NotebookOutlinePosition[     34493,        888]
CellTagsIndexPosition[     34450,        885]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Torus designs", "Title",
 CellChangeTimes->{{3.8418436141576233`*^9, 
  3.841843615919764*^9}},ExpressionUUID->"2621085b-0d08-4d97-974b-\
108c549f072e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"integrate", "[", 
    RowBox[{"n_", ",", "integrand_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "Pi"}], ")"}], "n"]], 
    RowBox[{"Integrate", "@@", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"integrand", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", 
             RowBox[{"\[Phi]", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "n", "]"}]}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "i", "]"}], ",", "0", ",", 
           RowBox[{"2", "Pi"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.841843636570691*^9, 3.841843657026597*^9}, {
  3.841843779818894*^9, 3.841843935392068*^9}, {3.8418439656303473`*^9, 
  3.841844041765505*^9}, {3.8418441208112593`*^9, 3.841844120918161*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"2b6f00f0-8d3a-4576-a601-5f3836e020d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"W1", "[", 
    RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w", "=", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"w", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}]}], 
          "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "M"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2", "[", 
    RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w", "=", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"w", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"k", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], ")"}]}], 
          "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "M"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841844273835939*^9, 3.841844314547584*^9}, {
  3.84184584558524*^9, 3.8418458457963753`*^9}, {3.841845927838049*^9, 
  3.8418459617027082`*^9}, {3.841845994668109*^9, 3.841846007364334*^9}, {
  3.841846065972311*^9, 3.841846207093975*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"64a8ec63-60f0-42e9-bf66-dc5ef01ba0dd"],

Cell[CellGroupData[{

Cell["One design", "Section",
 CellChangeTimes->{{3.8418464724201097`*^9, 
  3.841846474762837*^9}},ExpressionUUID->"6ffaba11-80df-4770-b067-\
7c027955dd81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"oneDesign", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"n", "+", "1"}]], ",", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"2", "Pi", " ", "q", " ", "#"}], 
          RowBox[{"n", "+", "1"}]], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "n"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8418462111522503`*^9, 3.841846295697261*^9}},
 CellLabel->
  "In[1045]:=",ExpressionUUID->"fe462830-4bda-4ad2-ae26-be70c160bd68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"W1", "[", 
           RowBox[{
            RowBox[{"oneDesign", "[", "n", "]"}], ",", "k"}], "]"}], 
          "\[NotEqual]", 
          TemplateBox[{RowBox[{
              RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]},
           "KroneckerDeltaSeq"]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"k", "-", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
        "]"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"n", "+", "1"}], "]"}], ",", "2"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.841846299824196*^9, 3.84184630044875*^9}, {
  3.8418464898159723`*^9, 3.84184649513164*^9}, {3.841855382810508*^9, 
  3.841855415755541*^9}},
 CellLabel->
  "In[1046]:=",ExpressionUUID->"9638d3b0-6f8f-4ac6-81b0-079938ae8823"]
}, Open  ]],

Cell[CellGroupData[{

Cell["One design not enough for a two design", "Section",
 CellChangeTimes->{{3.841846501559515*^9, 
  3.841846507823283*^9}},ExpressionUUID->"d317fb65-375b-4920-8012-\
ad995e1e6d0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W2", "[", 
   RowBox[{
    RowBox[{"oneDesign", "[", "2", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "3", ",", "1"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"want", " ", "0"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.841844145142597*^9, 3.841844268263651*^9}, {
   3.8418443001129303`*^9, 3.841844306774886*^9}, {3.8418459788924093`*^9, 
   3.8418460529659147`*^9}, 3.841846203209277*^9, {3.8418463129051027`*^9, 
   3.841846372516899*^9}, {3.841846512342226*^9, 3.841846516117984*^9}, {
   3.8418465462031403`*^9, 3.8418465804267683`*^9}, {3.841846622342252*^9, 
   3.841846628643491*^9}, {3.8418554309210367`*^9, 3.8418554323865843`*^9}, 
   3.841857816896296*^9},ExpressionUUID->"2985f727-d447-48fc-abbb-\
74f84cf23464"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.84184632474765*^9, 3.841846372930641*^9}, 
   3.841846580907136*^9, 3.841849654501741*^9, {3.841855433610949*^9, 
   3.8418554618576*^9}},
 CellLabel->
  "Out[1047]=",ExpressionUUID->"b9192af1-39a9-48b0-b3b0-1ad925f9a2e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exponentially large two design", "Section",
 CellChangeTimes->{{3.841846609851931*^9, 3.8418466119396553`*^9}, {
  3.841847352613599*^9, 
  3.8418473566394577`*^9}},ExpressionUUID->"f86579f7-7664-4224-9182-\
256d24217cf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"twoDesign", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["3", 
        RowBox[{"-", "n"}]], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"2", "Pi", " ", 
            RowBox[{"d", "[", 
             RowBox[{"[", 
              RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "3"], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "n"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "2"}], "]"}], ",", "n"}], "]"}]}], "}"}]}], 
        "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"W2", "[", 
           RowBox[{
            RowBox[{"twoDesign", "[", "n", "]"}], ",", "k"}], "]"}], 
          "\[NotEqual]", 
          RowBox[{
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "+", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "-", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}]}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"k", "-", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
        "]"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"n", "+", "1"}], "]"}], ",", "4"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.841846614664854*^9, 3.8418467112804813`*^9}, {
  3.841846751340691*^9, 3.84184676473177*^9}, {3.841846795071474*^9, 
  3.8418468758876553`*^9}, {3.84184690931248*^9, 3.841846924700708*^9}, {
  3.841846960865965*^9, 3.841846969099916*^9}, {3.8418471585892773`*^9, 
  3.841847201865348*^9}, {3.841847238497308*^9, 3.841847273718173*^9}, {
  3.8418473164926043`*^9, 3.841847372986752*^9}, {3.8418554396974583`*^9, 
  3.841855475514337*^9}},
 CellLabel->
  "In[1050]:=",ExpressionUUID->"650bb8db-f18f-4d96-8887-f1eb368724fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Smaller two design", "Section",
 CellChangeTimes->{{3.841846609851931*^9, 3.8418466119396553`*^9}, {
  3.841847352613599*^9, 3.8418473854596024`*^9}, {3.841855482249354*^9, 
  3.841855491880266*^9}, {3.841857799176585*^9, 
  3.841857800942922*^9}},ExpressionUUID->"e1211dbe-f5e1-4c02-9154-\
38a12fe27b09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"smallestPrime", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Prime", "[", "i", "]"}], "\[LessEqual]", "n"}], ",", 
        RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Prime", "[", "i", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.841856721397358*^9, 3.841856819872196*^9}, {
  3.8436579263951797`*^9, 
  3.84365792642852*^9}},ExpressionUUID->"e8b85ebc-1699-42e2-a3f6-\
4322c01f1f02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"twoDesignSmall", "[", "n_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", "=", 
        RowBox[{"smallestPrime", "[", "n", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["p", "2"]], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"2", "Pi", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"q", "#"}], "+", 
                   RowBox[{"q1", 
                    SuperscriptBox["#", "2"]}]}], ")"}]}], "p"], ")"}], "&"}],
              "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "n"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"q", ",", "0", ",", 
            RowBox[{"p", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "0", ",", 
            RowBox[{"p", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
        ",", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"W2", "[", 
           RowBox[{
            RowBox[{"twoDesignSmall", "[", "n", "]"}], ",", "k"}], "]"}], 
          "\[NotEqual]", 
          RowBox[{
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "+", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "-", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}]}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"k", "-", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
        "]"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"n", "+", "1"}], "]"}], ",", "4"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.841846614664854*^9, 3.8418467112804813`*^9}, {
   3.841846751340691*^9, 3.84184676473177*^9}, {3.841846795071474*^9, 
   3.8418468758876553`*^9}, {3.84184690931248*^9, 3.841846924700708*^9}, {
   3.841846960865965*^9, 3.841846969099916*^9}, {3.8418471585892773`*^9, 
   3.841847201865348*^9}, {3.841847238497308*^9, 3.841847273718173*^9}, {
   3.8418473164926043`*^9, 3.841847372986752*^9}, {3.841849587394493*^9, 
   3.841849664446446*^9}, {3.841849704732729*^9, 3.841849719296686*^9}, {
   3.8418497506991873`*^9, 3.841849773605978*^9}, {3.8418498248051558`*^9, 
   3.841849855450099*^9}, {3.8418500532501173`*^9, 3.84185006198582*^9}, {
   3.841850302994001*^9, 3.8418503265762672`*^9}, {3.8418503714268312`*^9, 
   3.841850394395092*^9}, {3.8418505202646093`*^9, 3.841850520490201*^9}, {
   3.841850557845492*^9, 3.841850615226617*^9}, {3.841850650396187*^9, 
   3.841850660509897*^9}, {3.841850692625162*^9, 3.841850725068334*^9}, {
   3.841850833051425*^9, 3.841850914597364*^9}, {3.8418511004677343`*^9, 
   3.841851106406684*^9}, {3.8418512046134*^9, 3.841851355509532*^9}, {
   3.841851401551075*^9, 3.841851532853704*^9}, {3.841851847519991*^9, 
   3.841851852483818*^9}, {3.8418518838852797`*^9, 3.841851889024043*^9}, {
   3.841851924439333*^9, 3.841852115585285*^9}, {3.841852244669859*^9, 
   3.8418522670641127`*^9}, {3.8418524194783373`*^9, 
   3.8418524674962473`*^9}, {3.84185250536345*^9, 3.8418527179834967`*^9}, {
   3.8418527687670717`*^9, 3.84185286334232*^9}, {3.841853153431716*^9, 
   3.841853221769388*^9}, {3.841853298537242*^9, 3.841853299215287*^9}, {
   3.841853489728084*^9, 3.841853489992742*^9}, {3.8418535359081306`*^9, 
   3.841853559464808*^9}, 3.841855370569023*^9, {3.8418563316791353`*^9, 
   3.8418563456278543`*^9}, {3.841856431915215*^9, 3.8418564563367233`*^9}, {
   3.841856656948735*^9, 3.841856710405452*^9}, {3.841856822394516*^9, 
   3.8418568247946978`*^9}, {3.841857803765839*^9, 3.84185780962888*^9}},
 CellLabel->
  "In[1077]:=",ExpressionUUID->"63a7d094-60c7-428e-98ac-c5fc2f29631e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Size ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "2"], TraditionalForm]],ExpressionUUID->
  "5d457bf3-a191-4d7d-9326-7c0e3031c434"],
 " 2-design for n<=6"
}], "Section",
 CellChangeTimes->{{3.876338102992799*^9, 
  3.876338127267696*^9}},ExpressionUUID->"923c6c86-9329-4725-be85-\
f000803b5b79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"twoDesignN2", "[", "n_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2", ",", "3", ",", "7", ",", "13", ",", "22"}], 
         "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["n", "2"]], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"2", "Pi", " ", "q", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], 
              SuperscriptBox["n", "2"]], ")"}], "&"}], "/@", 
           RowBox[{"Range", "[", "n", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"q", ",", "0", ",", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", "1"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"W2", "[", 
           RowBox[{
            RowBox[{"twoDesignN2", "[", "n", "]"}], ",", "k"}], "]"}], 
          "\[NotEqual]", 
          RowBox[{
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "+", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "-", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}]}]}], ",", 
         RowBox[{"Print", "[", "k", "]"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", "4"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.841846614664854*^9, 3.8418467112804813`*^9}, {
   3.841846751340691*^9, 3.84184676473177*^9}, {3.841846795071474*^9, 
   3.8418468758876553`*^9}, {3.84184690931248*^9, 3.841846924700708*^9}, {
   3.841846960865965*^9, 3.841846969099916*^9}, {3.8418471585892773`*^9, 
   3.841847201865348*^9}, {3.841847238497308*^9, 3.841847273718173*^9}, {
   3.8418473164926043`*^9, 3.841847372986752*^9}, {3.841849587394493*^9, 
   3.841849664446446*^9}, {3.841849704732729*^9, 3.841849719296686*^9}, {
   3.8418497506991873`*^9, 3.841849773605978*^9}, {3.8418498248051558`*^9, 
   3.841849855450099*^9}, {3.8418500532501173`*^9, 3.84185006198582*^9}, {
   3.841850302994001*^9, 3.8418503265762672`*^9}, {3.8418503714268312`*^9, 
   3.841850394395092*^9}, {3.8418505202646093`*^9, 3.841850520490201*^9}, {
   3.841850557845492*^9, 3.841850615226617*^9}, {3.841850650396187*^9, 
   3.841850660509897*^9}, {3.841850692625162*^9, 3.841850725068334*^9}, {
   3.841850833051425*^9, 3.841850914597364*^9}, {3.8418511004677343`*^9, 
   3.841851106406684*^9}, {3.8418512046134*^9, 3.841851355509532*^9}, {
   3.841851401551075*^9, 3.841851532853704*^9}, {3.841851847519991*^9, 
   3.841851852483818*^9}, {3.8418518838852797`*^9, 3.841851889024043*^9}, {
   3.841851924439333*^9, 3.841852115585285*^9}, {3.841852244669859*^9, 
   3.8418522670641127`*^9}, {3.8418524194783373`*^9, 
   3.8418524674962473`*^9}, {3.84185250536345*^9, 3.8418527179834967`*^9}, {
   3.8418527687670717`*^9, 3.84185286334232*^9}, {3.841853153431716*^9, 
   3.841853221769388*^9}, {3.841853298537242*^9, 3.841853299215287*^9}, {
   3.841853489728084*^9, 3.841853489992742*^9}, {3.8418535359081306`*^9, 
   3.841853559464808*^9}, 3.841855370569023*^9, {3.8418563316791353`*^9, 
   3.8418563456278543`*^9}, {3.841856431915215*^9, 3.8418564563367233`*^9}, {
   3.841856656948735*^9, 3.841856710405452*^9}, {3.841856822394516*^9, 
   3.8418568247946978`*^9}, {3.841857803765839*^9, 3.84185780962888*^9}, {
   3.87633693974714*^9, 3.876337050730652*^9}, 3.876337208812295*^9, {
   3.876337252816607*^9, 3.87633725614474*^9}, {3.876337287449843*^9, 
   3.876337380689499*^9}, {3.876337508804223*^9, 3.876337556075316*^9}, {
   3.8763381232621193`*^9, 3.876338123672638*^9}, {3.876338175280385*^9, 
   3.876338216722229*^9}, {3.876342887417285*^9, 3.876342892035804*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"548934de-0c43-422e-8119-42ee6e44d07c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "2"], "-", "n", "+", "1"}], TraditionalForm]],
  ExpressionUUID->"34071631-f37f-4b7e-966b-928797a1b343"],
 " (minimal) 2-design for n<=4"
}], "Section",
 CellChangeTimes->{{3.876338102992799*^9, 3.876338127267696*^9}, {
  3.8763410962518272`*^9, 3.8763411011105623`*^9}, {3.8763412746532784`*^9, 
  3.87634127989729*^9}},ExpressionUUID->"e0f9cff3-47d8-4292-b91e-\
ba73ada72df8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"twoDesignMinimal", "[", "n_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2", ",", "3", ",", "7"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["n", "2"], "-", "n", "+", "1"}]], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"2", "Pi", " ", "q", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], 
              RowBox[{
               SuperscriptBox["n", "2"], "-", "n", "+", "1"}]], ")"}], "&"}], 
           "/@", 
           RowBox[{"Range", "[", "n", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"q", ",", "0", ",", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", "n"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"W2", "[", 
           RowBox[{
            RowBox[{"twoDesignMinimal", "[", "n", "]"}], ",", "k"}], "]"}], 
          "\[NotEqual]", 
          RowBox[{
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "+", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}], "-", 
           RowBox[{
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"], 
            TemplateBox[{RowBox[{
                RowBox[{"k", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"k", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]},
             "KroneckerDeltaSeq"]}]}]}], ",", 
         RowBox[{"Print", "[", "k", "]"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", "4"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.841846614664854*^9, 3.8418467112804813`*^9}, {
   3.841846751340691*^9, 3.84184676473177*^9}, {3.841846795071474*^9, 
   3.8418468758876553`*^9}, {3.84184690931248*^9, 3.841846924700708*^9}, {
   3.841846960865965*^9, 3.841846969099916*^9}, {3.8418471585892773`*^9, 
   3.841847201865348*^9}, {3.841847238497308*^9, 3.841847273718173*^9}, {
   3.8418473164926043`*^9, 3.841847372986752*^9}, {3.841849587394493*^9, 
   3.841849664446446*^9}, {3.841849704732729*^9, 3.841849719296686*^9}, {
   3.8418497506991873`*^9, 3.841849773605978*^9}, {3.8418498248051558`*^9, 
   3.841849855450099*^9}, {3.8418500532501173`*^9, 3.84185006198582*^9}, {
   3.841850302994001*^9, 3.8418503265762672`*^9}, {3.8418503714268312`*^9, 
   3.841850394395092*^9}, {3.8418505202646093`*^9, 3.841850520490201*^9}, {
   3.841850557845492*^9, 3.841850615226617*^9}, {3.841850650396187*^9, 
   3.841850660509897*^9}, {3.841850692625162*^9, 3.841850725068334*^9}, {
   3.841850833051425*^9, 3.841850914597364*^9}, {3.8418511004677343`*^9, 
   3.841851106406684*^9}, {3.8418512046134*^9, 3.841851355509532*^9}, {
   3.841851401551075*^9, 3.841851532853704*^9}, {3.841851847519991*^9, 
   3.841851852483818*^9}, {3.8418518838852797`*^9, 3.841851889024043*^9}, {
   3.841851924439333*^9, 3.841852115585285*^9}, {3.841852244669859*^9, 
   3.8418522670641127`*^9}, {3.8418524194783373`*^9, 
   3.8418524674962473`*^9}, {3.84185250536345*^9, 3.8418527179834967`*^9}, {
   3.8418527687670717`*^9, 3.84185286334232*^9}, {3.841853153431716*^9, 
   3.841853221769388*^9}, {3.841853298537242*^9, 3.841853299215287*^9}, {
   3.841853489728084*^9, 3.841853489992742*^9}, {3.8418535359081306`*^9, 
   3.841853559464808*^9}, 3.841855370569023*^9, {3.8418563316791353`*^9, 
   3.8418563456278543`*^9}, {3.841856431915215*^9, 3.8418564563367233`*^9}, {
   3.841856656948735*^9, 3.841856710405452*^9}, {3.841856822394516*^9, 
   3.8418568247946978`*^9}, {3.841857803765839*^9, 3.84185780962888*^9}, {
   3.87633693974714*^9, 3.876337050730652*^9}, 3.876337208812295*^9, {
   3.876337252816607*^9, 3.87633725614474*^9}, {3.876337287449843*^9, 
   3.876337380689499*^9}, {3.876337508804223*^9, 3.876337556075316*^9}, {
   3.8763381232621193`*^9, 3.876338123672638*^9}, {3.876338175280385*^9, 
   3.876338216722229*^9}, {3.876341104400012*^9, 3.8763411288462057`*^9}, {
   3.8763411685709763`*^9, 3.8763411719861717`*^9}, {3.876341207647565*^9, 
   3.876341282672086*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"1c6e8740-7fa7-4aed-9ed2-f8fccfccfe55"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 903},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 98, "Title",ExpressionUUID->"2621085b-0d08-4d97-974b-108c549f072e"],
Cell[741, 27, 1283, 34, 116, "Input",ExpressionUUID->"2b6f00f0-8d3a-4576-a601-5f3836e020d1"],
Cell[2027, 63, 2966, 81, 199, "Input",ExpressionUUID->"64a8ec63-60f0-42e9-bf66-dc5ef01ba0dd"],
Cell[CellGroupData[{
Cell[5018, 148, 157, 3, 67, "Section",ExpressionUUID->"6ffaba11-80df-4770-b067-7c027955dd81"],
Cell[5178, 153, 714, 21, 48, "Input",ExpressionUUID->"fe462830-4bda-4ad2-ae26-be70c160bd68"],
Cell[5895, 176, 1422, 39, 146, "Input",ExpressionUUID->"9638d3b0-6f8f-4ac6-81b0-079938ae8823"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7354, 220, 183, 3, 67, "Section",ExpressionUUID->"d317fb65-375b-4920-8012-ad995e1e6d0a"],
Cell[CellGroupData[{
Cell[7562, 227, 787, 16, 30, "Input",ExpressionUUID->"2985f727-d447-48fc-abbb-74f84cf23464"],
Cell[8352, 245, 273, 5, 34, "Output",ExpressionUUID->"b9192af1-39a9-48b0-b3b0-1ad925f9a2e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8674, 256, 228, 4, 67, "Section",ExpressionUUID->"f86579f7-7664-4224-9182-256d24217cf6"],
Cell[8905, 262, 4440, 118, 288, "Input",ExpressionUUID->"650bb8db-f18f-4d96-8887-f1eb368724fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13382, 385, 311, 5, 67, "Section",ExpressionUUID->"e1211dbe-f5e1-4c02-9154-38a12fe27b09"],
Cell[13696, 392, 700, 19, 94, "Input",ExpressionUUID->"e8b85ebc-1699-42e2-a3f6-4322c01f1f02"],
Cell[14399, 413, 6242, 143, 374, "Input",ExpressionUUID->"63a7d094-60c7-428e-98ac-c5fc2f29631e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20678, 561, 321, 10, 68, "Section",ExpressionUUID->"923c6c86-9329-4725-be85-f000803b5b79"],
Cell[21002, 573, 6215, 136, 368, "Input",ExpressionUUID->"548934de-0c43-422e-8119-42ee6e44d07c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27254, 714, 466, 12, 68, "Section",ExpressionUUID->"e0f9cff3-47d8-4292-b91e-ba73ada72df8"],
Cell[27723, 728, 6407, 141, 368, "Input",ExpressionUUID->"1c6e8740-7fa7-4aed-9ed2-f8fccfccfe55"]
}, Open  ]]
}, Open  ]]
}
]
*)

